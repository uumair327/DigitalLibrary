<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Virtual Library</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap/dist/css/bootstrap.min.css">
    <link rel="stylesheet" href="styles/style.css">
</head>

<body>
  <header>
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
      <div class="container">
        <a class="navbar-brand" href="#">VIRTUAL LIBRARY</a>

        <!-- Mobile menu button -->
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav"
          aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <!-- Navigation links -->
        <div class="collapse navbar-collapse" id="navbarNav">
          <ul class="navbar-nav ml-auto">
            <li class="nav-item">
              <a class="nav-link" href="#categories">Categories</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#about-us">About Us</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="#" id="add-book-btn">Add Book</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Contact/contact.html">Feedback</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="Create-Account/create-account.html">Sign Up</a>
            </li>
          </ul>
        </div>
      </div>
    </nav>

    <div class="container mt-4">
      <div class="row">
        <div class="col-md-8">
          <h1>VIRTUAL LIBRARY</h1>
        </div>
        <div class="col-md-4">
          <div class="input-group">
            <input type="text" class="form-control" id="search-input" placeholder="Search for books...">
            <button class="btn btn-primary" id="search-button" type="button">Search</button>
          </div>
        </div>
      </div>
    </div>
  </header>

  <main class="container mt-4">
    <div id="book-container" class="row">
      <!-- Book cards will be displayed here -->
    </div>
  </main>
  

  <div id="categories" class="container mt-4">
    <h2>Categories</h2>
    <div class="row">
      <div class="col-md-3">
        <a href="frontend/books.html" class="btn btn-secondary">Fiction</a>
      </div>
      <div class="col-md-3">
        <a href="#" class="btn btn-secondary">Non-fiction</a>
      </div>
      <div class="col-md-3">
        <a href="#" class="btn btn-secondary">Biography</a>
      </div>
      <div class="col-md-3">
        <a href="#" class="btn btn-secondary">Children's books</a>
      </div>
    </div>
  </div>

  <div id="add-book-modal" class="modal">
    <!-- Add your modal content here -->
  </div>

  <footer id="about-us" class="container mt-4">
    <p>&copy; 2023 Virtual Library</p>
  </footer>

<!-- Include Firebase JavaScript SDK -->
<script src="https://www.gstatic.com/firebasejs/9.6.4/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.4/firebase-firestore.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.4/firebase-storage.js"></script>

<script type="module">
  // Import Firestore and Storage modules
  import { initializeApp } from "https://www.gstatic.com/firebasejs/9.6.4/firebase-app.js";
  import { getFirestore, collection, getDocs } from "https://www.gstatic.com/firebasejs/9.6.4/firebase-firestore.js";
  import { getStorage, ref, getDownloadURL } from "https://www.gstatic.com/firebasejs/9.6.4/firebase-storage.js";

  // Initialize Firebase with your configuration
    const firebaseConfig = {
    apiKey: "AIzaSyBtkNrppkM3fVHAX21YNwhLxiJT_ePtzAI",
    authDomain: "digitallibrary-4538e.firebaseapp.com",
    projectId: "digitallibrary-4538e",
    storageBucket: "digitallibrary-4538e.appspot.com",
    messagingSenderId: "109490219130",
    appId: "1:109490219130:web:014dc59401692db04733c3",
    measurementId: "G-ZWW8SKFE6Y"
  };

  const app = initializeApp(firebaseConfig);
  const firestore = getFirestore(app);
  const storage = getStorage(app);

  // Function to fetch and display books
  async function displayBooks() {
    const bookContainer = document.getElementById("book-container");

    // Replace with your Firestore collection name
    const collectionName = "books";

    const querySnapshot = await getDocs(collection(firestore, collectionName));

    querySnapshot.forEach(async (doc) => {
      const bookData = doc.data();
      // Convert storage paths to public URLs
      const coverUrl = await getDownloadURL(ref(storage, bookData.coverUrl));
      const pdfUrl = await getDownloadURL(ref(storage, bookData.pdfUrl));
      const otherFileUrl = bookData.otherFileUrl ? await getDownloadURL(ref(storage, bookData.otherFileUrl)) : '';

      const bookCard = createBookCard({ ...bookData, coverUrl, pdfUrl, otherFileUrl });
      bookContainer.appendChild(bookCard);
    });
  }

  // Function to create a book card
  function createBookCard(bookData) {
    const bookCard = document.createElement("div");
    bookCard.className = "col-md-4 book-card";
    bookCard.innerHTML = `
      <div class="book-card">
        <a href="${bookData.pdfUrl}" target="_blank">
          <img src="${bookData.coverUrl}" alt="Book Cover">
          <h3>Title: ${bookData.title}</h3>
        </a>
        <p>Description: ${bookData.description}</p>
        <a href="${bookData.pdfUrl}" target="_blank">Read PDF</a>
        ${bookData.otherFileUrl ? `<a href="${bookData.otherFileUrl}" target="_blank">Other Format</a>` : ''}
      </div>
    `;
    return bookCard;
  }

  // Call the function to display books
  displayBooks();
</script>
</body>

</html>